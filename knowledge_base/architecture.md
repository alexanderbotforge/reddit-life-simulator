# Architecture

**Версия документа:** 1.0.3  
**Последнее обновление:** 2025-02-01  
**Описание:** Высокоуровневая архитектура проекта Reddit Life Simulator.

---

## 1. Обзор системы

Reddit Life Simulator — автономная система долгосрочной имитации «жизни» Reddit-аккаунтов. Архитектура ориентирована на:

- Полную автономность без ручного вмешательства
- Один активный аккаунт в момент времени (очередь жизни)
- Браузерную эмуляцию (без API Reddit в v1.0)
- Устойчивость и восстановление состояния

---

## 2. Высокоуровневые компоненты

| Компонент | Назначение |
|-----------|------------|
| _Очередь жизни_ | Последовательная обработка аккаунтов |
| _Браузерная эмуляция_ | Реальный браузер с профилем на аккаунт |
| _Поведенческая модель_ | Сессии, усталость, ритм, допустимые действия |
| _Хранение состояния_ | Состояние по аккаунтам + сводный отчёт |
| _Контроль рисков_ | Капчи, редиректы, cooldown |
| _Отчётность_ | Ежедневный Telegram-отчёт |

_Детали компонентов см. в [components.md](components.md)._

---

## 3. Расположение кода

Весь код расположен в корне проекта. Главная точка входа — **rls.py** (Reddit Life Simulator). Модули: constants, config, state, browser (Playwright), behavior, risk, reporting. Тесты — в `tests/`, документация — в `docs/` и `knowledge_base/`. Переменные окружения — `.env` (шаблон `.env.example`); загрузка при старте через python-dotenv. CLI: `--config-dir`, `--state-dir`, `--dry-run`, `--send-daily-report`, `--daemon`, `--daemon-interval-minutes`.

---

## 4. Среда исполнения

- Отдельная выделенная машина
- Один процесс/инстанс системы
- Доступ к аккаунтам и машине в процессе работы не предполагается

---

## 5. Потоки данных

- **Вход:** конфигурация аккаунтов, прокси, таймзона, язык, регион
- **Выход:** логи, состояние аккаунтов, ежедневный Telegram-отчёт
- **Персистентность:** профиль браузера, состояние сессий, усталость, риски, паузы

---

## 6. Ограничения версии 1.0

- Нет комментариев
- Нет API Reddit для действий/наблюдения
- Нет смены прокси
- Нет параллельной работы аккаунтов
- Нет массового поведения и агрессивного роста

---

## 7. Расширяемость

- Архитектура допускает добавление комментариев через отдельный AI-модуль и риск-контроллер
- Структура конфигурации и состояния должна сохранять обратную совместимость при расширении

---

## Changelog

| Версия | Дата | Изменения |
|--------|------|-----------|
| 1.0.0 | 2025-02-01 | Первоначальная структура документа |
| 1.0.1 | 2025-02-01 | Добавлен раздел «Расположение кода» (rls.py, корень проекта) |
| 1.0.2 | 2025-02-01 | Playwright, .env, CLI daemon, обновление раздела «Расположение кода» |
| 1.0.3 | 2025-02-01 | Нумерация разделов 5→6 (Ограничения), добавлены --config-dir, --state-dir в CLI |
