# Что дальше — Reddit Life Simulator

**Версия:** 1.0.3  
**Дата:** 2025-02-01  

Реализовано в 1.0.2: браузерная эмуляция (Playwright), реальная отправка Telegram, ритм по таймзоне, демон, валидация прокси и маскировка в логах. Ниже — возможные доработки.

---

## 1. Браузерная эмуляция **[СДЕЛАНО в 1.0.2]**

**Сейчас:** В `browser.py` реализован Playwright: профиль, прокси, Reddit, скролл, upvote, подписка, детекция рисков.

**Нужно по ТЗ:**
- Реальный браузер с **постоянным профилем на аккаунт** (каталог из `account_config.profile_dir`).
- Запуск через **прокси** аккаунта (`account_config.proxy`).
- Открытие Reddit, нерегулярный скролл, паузы, «залипание» на постах (время из `behavior`).
- Изредка **upvote** (не более 1–2 за сессию, после просмотра контента).
- Очень редко **подписка на сабреддит** (только встреченный в ленте).
- **Детекция рисков:** капча, редиректы, аномальные задержки, ошибки интерфейса → вызов `on_risk`, возврат `risk_detected` в `SessionResult`.

**Варианты реализации:** Playwright или Selenium; профиль браузера — отдельная папка на аккаунт; прокси через аргументы запуска/настройки браузера.

**Зависимости:** playwright / selenium, возможно proxy-обвязка.

---

## 2. Реальная отправка Telegram-отчёта **[СДЕЛАНО в 1.0.2]**

**Сейчас:** `send_telegram_report()` в `reporting.py` отправляет отчёт через Bot API; токен и chat_id из `TELEGRAM_BOT_TOKEN`, `TELEGRAM_CHAT_ID`. Вызов при `python rls.py --send-daily-report` (в 23:58 по расписанию).

**Зависимости:** `requests` (уже в requirements.txt).

---

## 3. Ритм по таймзоне аккаунта **[СДЕЛАНО в 1.0.2]**

**Сейчас:** Будни/выходные считаются по таймзоне аккаунта (`timezone_str` в `behavior`).

**По ТЗ:** Часовой пояс аккаунта задаёт суточный и недельный ритм. Нужно использовать `account_config.timezone` (например, через `zoneinfo`) при расчёте «текущего времени» и длительности сессий в `behavior.py` и при планировании «когда запускать сессию» (если будет планировщик).

---

## 4. Планировщик / автономный цикл **[СДЕЛАНО в 1.0.2]**

**Сейчас:** Режим `--daemon` с `--daemon-interval-minutes`; в 23:58 отправляется отчёт.

**Опционально:** Демон/фоновый процесс, который сам в нужное время (с учётом таймзоны и ритма) запускает сессии и в 23:58 отправляет отчёт. Альтернатива — оставить cron (например, каждый час `rls.py` без `--send-daily-report`, и в 23:58 — с `--send-daily-report`).

---

## 5. Уточнения по конфигу и безопасности **[СДЕЛАНО в 1.0.2]**

- **Валидация прокси:** `validate_proxy()` в config; при неверном формате сессия пропускается.
- **Секреты:** токен Telegram из env; прокси в логах маскируется через `mask_proxy_for_log()`.

---

## Рекомендуемый порядок (выполнено в 1.0.2)

1. **Браузерная эмуляция** — реализовано (Playwright).
2. **Telegram-отчёт** — реализовано (Bot API, env).
3. **Ритм по таймзоне** — реализовано (timezone_str в behavior).
4. **Планировщик/демон** — реализовано (`--daemon`, `--daemon-interval-minutes`).

Дальнейшие доработки — по необходимости. После каждого шага обновлять версию, документацию (`knowledge_base`, `docs`), тесты и прогонять полный набор тестов.
